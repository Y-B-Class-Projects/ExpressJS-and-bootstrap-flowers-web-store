<style>
    /* Rounded border */
    hr.rounded {
        border-top: 5px solid #bbb;
        border-radius: 5px;
        max-width: 400px;
    }
</style>


<div class="container text-start">
    <div><br></div>
    <div class="table-responsive">
        <h1>Flower Catalog</h1>
        <hr align="left" class="rounded">
        <button id="refresh_btn" type="button" class="btn btn-outline-secondary btn-sm">
            <span class="glyphicon glyphicon-refresh"></span> Refresh
        </button>
        <table class="table">
            <thead>
                <tr>
                    <th class="text-end th-lg" scope="col">תיאור</th>
                    <th class="text-end th-lg" scope="col">מיקום הגידול</th>
                    <th class="text-end th-lg" scope="col">תמונה</th>
                    <th class="text-end th-lg" scope="col">שם הפרח</th>
                </tr>
            </thead>
            <tbody id="flowers_table">
            </tbody>
        </table>
    </div>
</div>

<script>
    $(document).ready(function () {
        refresh();
    });

    $('#refresh_btn').click(function () {
        refresh();
    });

    function refresh() {
        $('#flowers_table').html('');
        fetch('/flowers/data',
            {
                method: "POST",
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: "username=" + localStorage.getItem("user_name")
            })
            .then(function (res) { return res.json(); })
            .then(function (data) {
                jQuery.each(data, function (flower_name, val) {
                    $('#flowers_table').append(flower_to_table_row(flower_name, val.image_url, val.location, val.info))
                });
            })
    };

    function flower_to_table_row(flower_name, picture, place, characteristics) {
            console.log(flower_name, picture, place, characteristics)
            return `<tr>                    
                    <td class="text-end">${characteristics} </td>
                    <td class="text-end">${place} </td>
                    <td class="text-end"><img src="${picture}"  width="200"</td>
                    <td class="text-end">${flower_name} </td>
                    </tr>`
        }

</script>