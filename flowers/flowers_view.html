<style>
    /* Rounded border */
    hr.rounded {
        border-top: 5px solid #bbb;
        border-radius: 5px;
        max-width: 400px;
    }
</style>


<div class="container text-start">
    <div><br></div>
    <div class="table-responsive">
        <h1>Flower Catalog</h1>
        <hr align="left" class="rounded">
        <button id="refresh_btn" type="button" class="btn btn-outline-secondary btn-sm">
            <span class="glyphicon glyphicon-refresh"></span> Refresh
        </button>
        <button type="button" class="btn btn-info btn-sm" data-bs-toggle="modal" data-bs-target="#add_item_modal">Add
            flower</button>
        <table class="table">
            <thead>
                <tr>
                    <th class="text-end th-lg" scope="col">תיאור</th>
                    <th class="text-end th-lg" scope="col">מיקום הגידול</th>
                    <th class="text-end th-lg" scope="col">תמונה</th>
                    <th class="text-end th-lg" scope="col">שם הפרח</th>
                </tr>
            </thead>
            <tbody id="flowers_table">
            </tbody>
        </table>
    </div>


    <!-- Modal -->
    <div class="modal fade" id="add_item_modal" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Add flower</h4>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label for="recipient-name" class="col-form-label">Flower name:</label>
                            <input type="text" class="form-control" id="new_user_username">
                        </div>
                        <div class="form-group">
                            <label for="message-text" class="col-form-label">Growth location:</label>
                            <input type="text" class="form-control" id="new_user_pass">
                        </div>
                        <div class="form-group">
                            <label for="message-text" class="col-form-label">Description:</label>
                            <input type="text" class="form-control" id="new_user_al">
                        </div>
                        <div class="form-group">
                            <label for="message-text" class="col-form-label">Image:</label>
                            <input type="text" class="form-control" id="new_user_al">
                        </div>
                    </form>
                </div>
                <div class="modal-footer ">
                    <button type="button" class="btn btn-default" data-bs-dismiss="modal"
                        id="new_user_send_btn">Send</button>
                </div>
            </div>

        </div>
    </div>

</div>
<script>
    $(document).ready(function () {
        refresh();
    });

    $('#refresh_btn').click(function () {
        refresh();
    });

    function refresh() {
        $('#flowers_table').html('');
        fetch('/flowers/data',
            {
                method: "POST",
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: "username=" + localStorage.getItem("user_name")
            })
            .then(function (res) { return res.json(); })
            .then(function (data) {
                jQuery.each(data, function (flower_name, val) {
                    $('#flowers_table').append(flower_to_table_row(flower_name, val.image_url, val.location, val.info))
                });
            })
    };

    function flower_to_table_row(flower_name, picture, place, characteristics) {
        return `<tr>                    
                    <td class="text-end">${characteristics} </td>
                    <td class="text-end">${place} </td>
                    <td class="text-end"><img src="${picture}"  width="200"</td>
                    <td class="text-end">${flower_name} </td>
                    </tr>`
    }

</script>